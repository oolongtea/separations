% McCabe-Thiele Graphical Method Test %
close all; clear all; clc; format shortG;

y = [0 
0.1596223
0.2711635
0.3534956
0.4169607
0.4676358
0.5092972
0.5444017
0.5746099
0.6010809
0.6246458
0.6459152
0.6653464
0.6832883
0.7000111
0.7157273
0.7306056
0.744782
0.7583666
0.7714497
0.7841061
0.7963978
0.8083767
0.8200867
0.8315648
0.8428427
0.8539474
0.864902
0.8757266
0.8864383
0.8970522
0.9075813
0.9180486
0.928436
0.9387694
0.9490564
0.9593036
0.9695168
0.979701
0.9898608
1];

x = [0
0.025
0.05
0.075
0.1
0.125
0.15
0.175
0.2
0.225
0.25
0.275
0.3
0.325
0.35
0.375
0.4
0.425
0.45
0.475
0.5
0.525
0.55
0.575
0.6
0.625
0.65
0.675
0.7
0.725
0.75
0.775
0.8
0.825
0.85
0.875
0.9
0.925
0.95
0.975
1];

Mfeed = 14460; % kg/h
Wfeed = 10440; % kg/h
F = Mfeed + Wfeed; % kg/h
zF = (Mfeed/32) / ((Mfeed/32) + (Wfeed/18)); % volatile mole fraction at inlet
xD = 0.99;
xB = 0.01;
q = 1.12; %subcooled feed
R = 1.0;

mccabe_thiele(x, y, F, zF, xD, xB, R, q, 8);